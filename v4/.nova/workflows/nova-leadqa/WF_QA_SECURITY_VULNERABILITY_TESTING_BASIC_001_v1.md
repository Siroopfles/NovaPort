# Workflow: Basic Security Vulnerability Testing (WF_QA_SECURITY_VULNERABILITY_TESTING_BASIC_001_v1)

**Goal:** To perform a basic set of automated and/or checklist-based security vulnerability scans against the application to identify common vulnerabilities (e.g., OWASP Top 10 basics). This is NOT a full penetration test but a preliminary check.

**Primary Orchestrator Actor:** Nova-LeadQA (receives task from Nova-Orchestrator, often as part of pre-release validation or if `NovaSystemConfig` mandates periodic security scans).
**Primary Specialist Actor (delegated to by Nova-LeadQA):** Nova-SpecializedTestExecutor (with skills/tools for basic security scanning).

**Trigger / Nova-LeadQA Recognition:**
- Nova-Orchestrator delegates: "Perform basic security scan for [Application/Module] build [Version]."
- Part of `WF_QA_RELEASE_CANDIDATE_VALIDATION_001_v1.md` or a PCI/security compliance checklist.
- `NovaSystemConfig:ActiveSettings.mode_behavior.nova-leadqa.security_scan_frequency` triggers a scan.

**Pre-requisites by Nova-LeadQA:**
- Application build is deployed to a suitable, isolated test environment.
- List of common vulnerabilities to check (e.g., OWASP Top 10 checklist, relevant items from `ProjectConfig:ActiveConfig.security_testing_checklist_ref_key`).
- (Optional) Automated security scanning tools (e.g., OWASP ZAP, Nikto, or project-specific linters/scanners) are available and configured (tool commands in `ProjectConfig`).

**Phases & Steps (managed by Nova-LeadQA within its single active task from Nova-Orchestrator):**

**Phase SVT.1: Planning & Tool Setup by Nova-LeadQA**

1.  **Nova-LeadQA: Receive Task & Plan Security Scan**
    *   **Action:** Parse `Subtask Briefing Object`. Log `Progress` (integer `id`): "Basic Security Scan: [Target] - [Date]".
    *   Create internal plan (`CustomData LeadPhaseExecutionPlan:[SecScanProgressID]_QAPlan` (key)):
        1.  Configure & Run Automated Scanners (TestExecutor).
        2.  Execute Manual Checklist Review for Key Areas (TestExecutor).
        3.  Analyze Scanner Outputs & Checklist Results (TestExecutor/LeadQA).
        4.  Log Identified Vulnerabilities as `ErrorLogs` (TestExecutor/LeadQA).
        5.  Compile Security Scan Report (TestExecutor/LeadQA).
    *   **ConPort:** Review `ProjectConfig:ActiveConfig.security_testing_tools` (key) and `security_testing_checklist_ref_key`. Log `Decision` (integer `id`) to start the basic security scan.
    *   **Output:** Plan ready.

**Phase SVT.2: Scan Execution & Analysis by Nova-SpecializedTestExecutor (Sequentially Managed)**

2.  **Nova-LeadQA -> Delegate to Nova-SpecializedTestExecutor: Run Automated Scanners**
    *   **Task:** "Configure and run automated security scanning tools against [TargetApplicationURL/Endpoints]."
    *   **`new_task` message for Nova-SpecializedTestExecutor:**
        ```
        Subtask_Briefing:
          Overall_QA_Phase_Goal: "Basic Security Scan for [Target]."
          Specialist_Subtask_Goal: "Execute automated security scans (e.g., ZAP, Nikto) against [TargetApplicationURL]."
          Specialist_Specific_Instructions:
            - "1. Target URL/Endpoints: [From LeadQA / ProjectConfig]."
            - "2. Configure tool [ToolName from ProjectConfig] with appropriate scope and policies (e.g., passive scan, light active scan â€“ AVOID destructive scans unless explicitly approved and isolated)."
            - "3. Execute scanner tool using command: [`ProjectConfig:ActiveConfig.security_testing_tools.zap_cli_command`] (example)."
            - "4. Collect all output reports from the scanner (e.g., HTML, XML, JSON)."
            - "5. Save raw reports to `.nova/reports/security/[Target]_[ToolName]_[Date]/`."
          Required_Input_Context_For_Specialist:
            - Target_Application_URL_Endpoints: "[...]"
            - ProjectConfig_Ref: { type: "custom_data", category: "ProjectConfig", key: "ActiveConfig", fields_needed: ["security_testing_tools"] }
          Expected_Deliverables_In_Attempt_Completion_From_Specialist:
            - "Confirmation of scanner execution."
            - "Path to raw scanner reports in `.nova/reports/`."
            - "Initial summary of high-level alert counts from scanners."
        ```
    *   **Nova-LeadQA Action:** Monitor. Update plan/progress.

3.  **Nova-LeadQA -> Delegate to Nova-SpecializedTestExecutor: Manual Checklist Review**
    *   **Task:** "Perform a manual review against a basic security checklist for key areas of [TargetApplication]."
    *   **Briefing for TestExecutor:** Provide checklist (e.g., from ConPort `CustomData SecurityChecklists:BasicWebScan_v1` (key) or `ProjectConfig`). Focus areas: input validation, output encoding (XSS), basic auth/session checks, common misconfigurations.
    *   **Nova-LeadQA Action:** Monitor.

**Phase SVT.3: Vulnerability Logging & Reporting by Nova-LeadQA & Nova-SpecializedTestExecutor**

4.  **Nova-LeadQA (can delegate detailed analysis to TestExecutor or Nova-FlowAsk): Consolidate Findings & Log Vulnerabilities**
    *   **Task:** "Analyze all scanner reports and checklist findings. For each credible, unique vulnerability, log it as a new `ErrorLogs` (key) entry with 'Security' type and appropriate severity."
    *   **Logic for Nova-LeadQA/TestExecutor:**
        *   Filter out false positives from scanners.
        *   For each valid finding:
            *   Log a new `CustomData ErrorLogs:[YYYYMMDD_SecurityVuln_ShortDesc]` (key) (R20 compliant, ensure `error_message` describes vulnerability, `reproduction_steps` show how to exploit/observe, set `severity` appropriately e.g., CRITICAL/HIGH/MEDIUM_SECURITY_VULN).
            *   Link to scanner report/checklist item if possible.
        *   Update `active_context.open_issues`.
    *   **Output:** All identified vulnerabilities logged as `ErrorLogs` (key).

5.  **Nova-LeadQA -> Delegate to Nova-SpecializedTestExecutor (or self): Compile Security Scan Report**
    *   **Task:** "Compile a summary report for the basic security scan."
    *   **Briefing:** Report should include scope, tools/checklists used, summary of automated findings, summary of manual findings, list of all new `ErrorLogs` (keys) created with severity, and overall basic security posture assessment. Save to `.nova/reports/security/OverallScanReport_[Target]_[Date].md`.
    *   **Nova-LeadQA Action:** Review report.

6.  **Nova-LeadQA: Finalize Cycle & Report to Nova-Orchestrator**
    *   **Action:**
        *   Update main `Progress` (integer `id`) for "Basic Security Scan" to DONE (or DONE_WITH_VULNERABILITIES_FOUND).
        *   Update `active_context.state_of_the_union` with summary: "Basic security scan for [Target] complete. Findings: [X critical, Y high]. Report: [Path/Key]."
    *   **`attempt_completion` to Nova-Orchestrator:** Report completion, summary of vulnerabilities found (especially critical/high `ErrorLogs` keys), and reference to the full scan report.

**Key ConPort Items Involved:**
-   `Progress` (integer `id`)
-   `CustomData LeadPhaseExecutionPlan:[SecScanProgressID]_QAPlan` (key)
-   `Decisions` (integer `id`) (e.g., to accept certain low-risk findings, or to prioritize fixing a critical one)
-   `CustomData ErrorLogs:[key]` (key) (new security vulnerabilities logged)
-   `CustomData SecurityChecklists:[key]` (key) (Read, if used)
-   `ActiveContext` (`state_of_the_union`, `open_issues` updates)
-   Reads `ProjectConfig:ActiveConfig` (key) (for tool commands, checklist refs).