# Workflow: Basic Security Vulnerability Testing (WF_QA_SECURITY_VULNERABILITY_TESTING_BASIC_001_v1)

**Goal:** To perform a basic set of automated and/or checklist-based security vulnerability scans against the application to identify common vulnerabilities (e.g., OWASP Top 10 basics). This is NOT a full penetration test but a preliminary check.

**Primary Actor:** Nova-LeadQA (receives task from Nova-Orchestrator, often as part of pre-release validation or if `NovaSystemConfig` mandates periodic security scans).
**Primary Specialist Actor (delegated to by Nova-LeadQA):** Nova-SpecializedTestExecutor (with skills/tools for basic security scanning).

**Trigger / Recognition:**
- Nova-Orchestrator delegates: "Perform basic security scan for [Application/Module] build [Version] on Project [ProjectName]".
- Part of `WF_QA_RELEASE_CANDIDATE_VALIDATION_001_v1.md` or a PCI/security compliance checklist activity.
- `CustomData NovaSystemConfig:ActiveSettings.mode_behavior.nova-leadqa.security_scan_frequency_days` triggers a scan.

**Pre-requisites by Nova-LeadQA (from Nova-Orchestrator's briefing or ConPort):**
- Application build is deployed to a suitable, isolated test environment (URL/access from `CustomData ProjectConfig:ActiveConfig.testing_preferences.security_scan_env` (key)).
- List of common vulnerabilities to check (e.g., OWASP Top 10 checklist, relevant items from `CustomData ProjectConfig:ActiveConfig.security_testing_checklist_ref_key` (key), or a file path like `docs/qa/security_checklist_basic.md`).
- (Optional) Automated security scanning tools (e.g., OWASP ZAP, Nikto, or project-specific linters/scanners) are available and configured (tool commands in `ProjectConfig:ActiveConfig.security_testing_tools.[tool_name]_command`).

**Phases & Steps (managed by Nova-LeadQA within its single active task from Nova-Orchestrator):**

**Phase SVT.1: Planning & Tool Setup**

1.  **Nova-LeadQA: Receive Task & Plan Security Scan**
    *   **Actor:** Nova-LeadQA
    *   **Action:**
        *   Parse `Subtask Briefing Object` from Nova-Orchestrator. Identify Target Application/Module and Build.
        *   Log main `Progress` (integer `id`) item using `use_mcp_tool` (`tool_name: 'log_progress'`): "Basic Security Scan: [Target] - [Date]". Let this be `[SecScanProgressID]`.
        *   Create internal plan in `CustomData LeadPhaseExecutionPlan:[SecScanProgressID]_QAPlan` (key) using `use_mcp_tool`. Plan items:
            1.  Configure & Run Automated Scanners (Delegate to TestExecutor).
            2.  Execute Manual Checklist Review for Key Areas (Delegate to TestExecutor).
            3.  Analyze Scanner Outputs & Checklist Results (LeadQA, with TestExecutor input).
            4.  Log Identified Vulnerabilities as `ErrorLogs` (LeadQA, with TestExecutor input).
            5.  Compile Security Scan Report (Delegate report drafting to TestExecutor or ConPortSteward).
    *   **ConPort Action:**
        *   Review `CustomData ProjectConfig:ActiveConfig` (key) for `security_testing_tools` and `security_testing_checklist_ref_key` using `use_mcp_tool` (`tool_name: 'get_custom_data'`).
        *   If a checklist file is referenced, use `read_file` to load its content for briefing TestExecutor.
        *   Log `Decision` (integer `id`) using `use_mcp_tool` (`tool_name: 'log_decision'`) to start the basic security scan, noting scope and tools to be used. Link to `[SecScanProgressID]`.
    *   **Output:** Plan ready. `[SecScanProgressID]` known.

**Phase SVT.2: Scan Execution & Analysis by Nova-SpecializedTestExecutor (Sequentially Managed)**

2.  **Nova-LeadQA -> Delegate to Nova-SpecializedTestExecutor: Run Automated Scanners**
    *   **Actor:** Nova-LeadQA
    *   **Task:** "Configure and run automated security scanning tools against [TargetApplicationURL/Endpoints]."
    *   **`new_task` message for Nova-SpecializedTestExecutor:**
        ```json
        {
          "Context_Path": "[ProjectName] (SecurityScan_[Target]) -> AutomatedScan (TestExecutor)",
          "Overall_QA_Phase_Goal": "Basic Security Scan for [Target].",
          "Specialist_Subtask_Goal": "Execute automated security scans (e.g., ZAP, Nikto) against [TargetApplicationURL].",
          "Specialist_Specific_Instructions": [
            "Log your own `Progress` (integer `id`), parented to `[SecScanProgressID]`.",
            "Target URL/Endpoints: [URL_From_LeadQA_or_ProjectConfig].",
            "1. For each tool specified by LeadQA (e.g., ZAP, Nikto):",
            "   a. Configure tool with appropriate scope and policies (e.g., passive scan, light active scan â€“ AVOID destructive scans unless explicitly approved and isolated environment confirmed). Refer to `ProjectConfig:ActiveConfig.security_testing_tools.[tool_name]_default_policy` if available.",
            "   b. Execute scanner tool using command: [`ProjectConfig:ActiveConfig.security_testing_tools.[tool_name]_command`] (example, LeadQA will specify exact command if not standard). Use `execute_command`.",
            "   c. Collect all output reports from the scanner (e.g., HTML, XML, JSON).",
            "   d. Save raw reports to `.nova/reports/qa/security/[Target]_[ToolName]_[Date]/[report_file]` using `write_to_file`."
          ],
          "Required_Input_Context_For_Specialist": {
            "Parent_Progress_ID_String": "[SecScanProgressID_as_string]",
            "Target_Application_URL_Endpoints": "[...]",
            "List_Of_Tools_To_Run_With_Commands": "[{tool_name: 'ZAP', command: 'zap-cli quick-scan ...'}, {...}]", // Provided by LeadQA
            "ProjectConfig_Ref_For_Tool_Paths_Policies": { "type": "custom_data", "category": "ProjectConfig", "key": "ActiveConfig", "fields_needed": ["security_testing_tools"] }
          },
          "Expected_Deliverables_In_Attempt_Completion_From_Specialist": [
            "Confirmation of scanner(s) execution.",
            "Path(s) to raw scanner reports in `.nova/reports/qa/security/`.",
            "Initial summary of high-level alert counts per scanner."
          ]
        }
        ```
    *   **Nova-LeadQA Action after Specialist's `attempt_completion`:** Review execution status and initial alert counts. Update plan/progress.

3.  **Nova-LeadQA -> Delegate to Nova-SpecializedTestExecutor: Manual Checklist Review**
    *   **Actor:** Nova-LeadQA
    *   **DoR Check:** Automated scans complete or running in parallel if feasible.
    *   **Task:** "Perform a manual review against a basic security checklist (e.g., OWASP Top 10 subset) for key areas of [TargetApplication]."
    *   **`new_task` message for Nova-SpecializedTestExecutor (schematic):**
        ```json
        {
          "Context_Path": "[ProjectName] (SecurityScan_[Target]) -> ManualChecklistReview (TestExecutor)",
          "Overall_QA_Phase_Goal": "Basic Security Scan for [Target].",
          "Specialist_Subtask_Goal": "Execute manual security checklist for key areas of [TargetApplication].",
          "Specialist_Specific_Instructions": [
            "Log your own `Progress` (integer `id`), parented to `[SecScanProgressID]`.",
            "Target Application/Module: [Target_From_LeadQA].",
            "Security Checklist (Content or Path/ConPort Key from LeadQA): [docs/qa/security_checklist_basic.md or CustomData SecurityChecklists:BasicWebScan_v1]",
            "1. If checklist is a file, use `read_file` to get its content.",
            "2. Systematically go through each item on the checklist for the specified target areas (e.g., Login page, User profile, Admin interface).",
            "3. For each check item, record: Check Item ID/Name, Steps Performed, Observed Result, Pass/Fail, Evidence (e.g., URL, input data, screenshot description).",
            "4. Compile findings into a structured list or simple report."
          ],
          "Required_Input_Context_For_Specialist": {
            "Parent_Progress_ID_String": "[SecScanProgressID_as_string]",
            "Target_Application_Or_Module": "[...]",
            "Security_Checklist_Content_Or_Reference": "[...]"
          },
          "Expected_Deliverables_In_Attempt_Completion_From_Specialist": ["Structured list/report of manual checklist findings (pass/fail per item, evidence for fails)."]
        }
        ```
    *   **Nova-LeadQA Action after Specialist's `attempt_completion`:** Review manual findings. Update plan/progress.

**Phase SVT.3: Vulnerability Logging & Reporting**

4.  **Nova-LeadQA (can delegate detailed analysis of specific scanner outputs to TestExecutor or Nova-FlowAsk): Consolidate Findings & Log Vulnerabilities**
    *   **Actor:** Nova-LeadQA
    *   **Action:**
        *   Retrieve and thoroughly analyze all scanner reports and manual checklist findings.
        *   Filter out false positives from automated scanners (may require some initial investigation or comparison with baseline).
        *   For each credible, unique vulnerability identified:
            *   Log a new `CustomData ErrorLogs:[YYYYMMDD_SecurityVuln_ShortDesc]` (key) entry (R20 compliant) using `use_mcp_tool` (`tool_name: 'log_custom_data'`). Ensure `error_message` describes the vulnerability (e.g., "XSS in search field", "SQL Injection possible via param X"), `reproduction_steps` show how to exploit/observe, set `severity` appropriately (e.g., CRITICAL_SECURITY_VULN, HIGH_SECURITY_VULN), include CVE ID if known.
            *   Link the new `ErrorLogs` (key) entry to this security scan `Progress` item (`[SecScanProgressID]`) using `use_mcp_tool` (`tool_name: 'link_conport_items'`, `relationship_type: 'found_during_security_scan'`).
        *   Coordinate update of `active_context.open_issues` (via Nova-Orchestrator to LeadArchitect/ConPortSteward).
    *   **Output:** All identified vulnerabilities logged as `ErrorLogs` (key). List of corresponding `ErrorLogs` keys. Update `[SecScanProgressID]_QAPlan`.

5.  **Nova-LeadQA -> Delegate to Nova-SpecializedTestExecutor (or ConPortSteward via LeadArchitect): Compile Security Scan Report**
    *   **Actor:** Nova-LeadQA
    *   **Task:** "Compile a summary report for the basic security scan."
    *   **`new_task` message (schematic):**
        ```json
        {
          "Context_Path": "[ProjectName] (SecurityScan_[Target]) -> CompileReport (TestExecutor/ConPortSteward)",
          // ... Overall Goal, Specialist Goal ...
          "Specialist_Specific_Instructions": [
            "Consolidate findings into a Markdown report: `.nova/reports/qa/security/OverallScanReport_[Target]_[Date].md` using `write_to_file` OR log to `CustomData TestExecutionReports:SecurityScan_[Target]_[Date]` (key) using `use_mcp_tool` (`tool_name: 'log_custom_data'`).",
            "Report should include: Scope, Tools/Checklists Used, Summary of Automated Findings, Summary of Manual Findings, List of all new `ErrorLogs` (keys) created with Severity, Overall Basic Security Posture Assessment (e.g., 'Critical vulnerabilities found, immediate action required', 'Some medium risks identified, recommend mitigation', 'No major issues found in basic scan')."
          ],
          "Required_Input_Context_For_Specialist": { /* Consolidated_Findings_From_LeadQA */ },
          "Expected_Deliverables_In_Attempt_Completion_From_Specialist": ["Path/Key of the compiled report."]
        }
        ```
    *   **Nova-LeadQA Action:** Review report.

6.  **Nova-LeadQA: Finalize Cycle & Report to Nova-Orchestrator**
    *   **Actor:** Nova-LeadQA
    *   **Action:**
        *   Update main `Progress` (`[SecScanProgressID]`) to DONE (or DONE_WITH_VULNERABILITIES_FOUND) using `use_mcp_tool` (`tool_name: 'update_progress'`). Update description.
        *   To update `active_context`, first `get_active_context` with `use_mcp_tool`, then construct a new value object with the modified `state_of_the_union`, and finally use `log_custom_data` with category `ActiveContext` and key `active_context` to overwrite.
    *   **`attempt_completion` to Nova-Orchestrator:** Report completion, summary of vulnerabilities found (especially critical/high `ErrorLogs` keys), and reference to the full scan report. Request prioritization for fixing identified vulnerabilities.

**Key ConPort Items Involved:**
- Progress (integer `id`): Overall cycle, specialist subtasks.
- CustomData LeadPhaseExecutionPlan:[SecScanProgressID]_QAPlan (key).
- Decisions (integer `id`) (e.g., to accept certain low-risk findings, or to prioritize fixing a critical one).
- CustomData ErrorLogs:[key] (new security vulnerabilities logged).
- CustomData SecurityChecklists:[key] (Read, if used for manual checks).
- CustomData TestExecutionReports:[key] (optional, for detailed report storage).
- ActiveContext (`state_of_the_union`, `open_issues` updates).
- Reads `ProjectConfig:ActiveConfig` (key) (for tool commands, checklist refs, environment details).